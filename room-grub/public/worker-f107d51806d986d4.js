self.addEventListener("push",t=>{let i={title:"RoomGrub Notification",body:"You have a new notification",icon:"/icons/logo-192.png",badge:"/icons/logo-72.png",tag:"roomgrub-notification",data:{}};if(t.data)try{let e=t.data.json();i={...i,...e}}catch(e){i.body=t.data.text()}let e={body:i.body,icon:i.icon,badge:i.badge,tag:i.tag,data:i.data,actions:i.actions||[{action:"view",title:"View Room",icon:"/icons/logo-48.png"},{action:"dismiss",title:"Dismiss"}],requireInteraction:!1,vibrate:[200,100,200],timestamp:Date.now()};t.waitUntil(self.registration.showNotification(i.title,e))}),self.addEventListener("notificationclick",t=>{t.notification.close();let i=t.action,e=t.notification.data;if("dismiss"===i)return;let o="/";e&&e.roomId&&(o="/".concat(e.roomId),"grocery"===e.activityType?o+="/addgroccery":"payment"===e.activityType?o+="/payments":"expense"===e.activityType?o+="/expenses":"member_join"===e.activityType&&(o+="/members")),t.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then(t=>{for(let i=0;i<t.length;i++){let o=t[i];if(e&&e.roomId&&o.url.includes("/".concat(e.roomId))&&"focus"in o)return o.postMessage({type:"NOTIFICATION_CLICK",data:e}),o.focus()}if(clients.openWindow)return clients.openWindow(o)}))}),self.addEventListener("message",t=>{t.data&&"SKIP_WAITING"===t.data.type&&self.skipWaiting()});